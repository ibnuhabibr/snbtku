{"version":3,"file":"Login-DFg31HSt.js","sources":["../../src/pages/Login.tsx"],"sourcesContent":["import { useEffect } from \"react\";\nimport { useNavigate, Link } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport * as z from \"zod\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuthStore } from \"@/stores/authStore\";\nimport { authService } from \"@/services/authService\";\nimport { signInWithGoogle } from \"@/lib/firebase\";\n\n// Skema validasi untuk form login\nconst loginSchema = z.object({\n  email: z.string().email({\n    message: \"Email tidak valid\",\n  }),\n  password: z.string().min(6, {\n    message: \"Password minimal 6 karakter\",\n  }),\n});\n\ntype LoginFormValues = z.infer<typeof loginSchema>;\n\nconst Login = () => {\n  const navigate = useNavigate();\n  const { toast } = useToast();\n  const { isAuthenticated, isLoading, error, login } = useAuthStore();\n\n  // Redirect to dashboard if user is already logged in\n  useEffect(() => {\n    if (isAuthenticated) {\n      navigate('/dashboard');\n    }\n  }, [isAuthenticated, navigate]);\n\n  // Inisialisasi form dengan react-hook-form dan zod validator\n  const form = useForm<LoginFormValues>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  // Handler untuk login dengan email dan password\n  const onSubmit = async (data: LoginFormValues) => {\n    try {\n      await authService.login({\n        email: data.email,\n        password: data.password,\n      });\n      \n      toast({\n        title: \"Login berhasil\",\n        description: \"Selamat datang kembali!\",\n      });\n      \n      navigate(\"/dashboard\");\n    } catch (error: any) {\n      console.error(\"Login error:\", error);\n      toast({\n        title: \"Login gagal\",\n        description: error.message || \"Terjadi kesalahan saat login\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  // Handler untuk login dengan Google\n  const handleGoogleSignIn = async () => {\n    try {\n      console.log('Starting Google sign-in...');\n      const result = await signInWithGoogle();\n      const firebaseUser = result.user;\n      console.log('Firebase user:', firebaseUser);\n      \n      const requestData = {\n        email: firebaseUser.email || '',\n        name: firebaseUser.displayName || 'User',\n        firebaseUid: firebaseUser.uid\n      };\n      console.log('Sending request data:', requestData);\n      \n      // Kirim data ke backend menggunakan endpoint Google OAuth\n      const response = await fetch('http://localhost:3001/api/v1/auth/google', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(requestData),\n      });\n\n      console.log('Response status:', response.status);\n      console.log('Response ok:', response.ok);\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        console.error('Backend error response:', errorData);\n        throw new Error(errorData.error || 'Google authentication failed');\n      }\n\n      const data = await response.json();\n      console.log('Backend success response:', data);\n      \n      // Update auth store\n      login(data.user, data.token);\n      \n      toast({\n        title: \"Login berhasil\",\n        description: `Selamat datang kembali, ${firebaseUser.displayName}!`,\n      });\n      \n      navigate(\"/dashboard\");\n    } catch (error: any) {\n      console.error(\"Google sign-in error:\", error);\n      console.error(\"Error stack:\", error.stack);\n      toast({\n        title: \"Login gagal\",\n        description: `Terjadi kesalahan: ${error.message}`,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 via-background to-accent/5 p-4\">\n      <Card className=\"w-full max-w-md shadow-lg\">\n        <CardHeader className=\"space-y-1\">\n          <CardTitle className=\"text-2xl font-bold text-center\">Login</CardTitle>\n          <CardDescription className=\"text-center\">\n            Masukkan email dan password untuk mengakses akun Anda\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          {error && (\n            <Alert variant=\"destructive\" className=\"mb-4\">\n              <AlertDescription>{error}</AlertDescription>\n            </Alert>\n          )}\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input \n                        placeholder=\"nama@email.com\" \n                        type=\"email\" \n                        disabled={isLoading} \n                        {...field} \n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input \n                        placeholder=\"******\" \n                        type=\"password\" \n                        disabled={isLoading} \n                        {...field} \n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\n                {isLoading ? \"Memproses...\" : \"Login\"}\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"relative my-4\">\n            <div className=\"absolute inset-0 flex items-center\">\n              <span className=\"w-full border-t\" />\n            </div>\n            <div className=\"relative flex justify-center text-xs uppercase\">\n              <span className=\"bg-background px-2 text-muted-foreground\">Atau</span>\n            </div>\n          </div>\n\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            className=\"w-full\"\n            onClick={handleGoogleSignIn}\n            disabled={isLoading}\n          >\n            <svg className=\"mr-2 h-4 w-4\" viewBox=\"0 0 24 24\">\n              <path\n                fill=\"currentColor\"\n                d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\n              />\n              <path\n                fill=\"currentColor\"\n                d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\n              />\n              <path\n                fill=\"currentColor\"\n                d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\n              />\n              <path\n                fill=\"currentColor\"\n                d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\n              />\n            </svg>\n            Masuk dengan Google\n          </Button>\n\n        </CardContent>\n        <CardFooter className=\"flex flex-col space-y-2\">\n          <div className=\"text-center text-sm\">\n            <Link to=\"/forgot-password\" className=\"text-primary hover:underline\">\n              Lupa password?\n            </Link>\n          </div>\n          <div className=\"text-center text-sm\">\n            Belum punya akun?{\" \"}\n            <Link to=\"/register\" className=\"text-primary hover:underline\">\n              Daftar sekarang\n            </Link>\n          </div>\n        </CardFooter>\n      </Card>\n    </div>\n  );\n};\n\nexport default Login;"],"names":["loginSchema","z.object","email","z.string","message","password","min","Login","navigate","useNavigate","toast","useToast","isAuthenticated","isLoading","error","login","useAuthStore","useEffect","form","useForm","resolver","zodResolver","defaultValues","className","children","jsxs","Card","CardHeader","jsx","CardTitle","CardDescription","CardContent","Alert","variant","AlertDescription","Form","onSubmit","handleSubmit","async","data","authService","title","description","FormField","control","name","render","field","FormItem","FormLabel","FormControl","Input","placeholder","type","disabled","FormMessage","Button","onClick","firebaseUser","signInWithGoogle","user","requestData","displayName","firebaseUid","uid","response","fetch","method","headers","body","JSON","stringify","ok","errorData","json","Error","token","viewBox","fill","d","CardFooter","Link","to"],"mappings":"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"}