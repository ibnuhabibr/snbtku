import{j as e,f as s,p as a,m as t,w as l,ap as r,t as n,s as i,aq as c}from"./ui-vendor-BwAhdcts.js";import{r as m}from"./router-vendor-xnFU-SGQ.js";import{e as d,C as x,b as o,c as h,a as u,A as j,o as p,p as g,B as f,w as N,N as b}from"./index-CImf8UwA.js";import{T as v,a as w,b as y,c as k}from"./tabs-2oAGv6oB.js";import{B as _}from"./badge-Def1q0WS.js";import{I as C}from"./input-B1kw1Jk2.js";import"./react-vendor-DEQ385Nk.js";import"./supabase-vendor-Bj79fh9f.js";const S=({onUserSelect:n,showAddFriend:i=!0})=>{const[c,b]=m.useState(""),[v,w]=m.useState([]),[y,k]=m.useState(!1),[S,D]=m.useState(null),{toast:P}=d();return m.useEffect(()=>{const e=setTimeout(()=>{(async e=>{var s,a;if(e.trim().length<2)return w([]),void D(null);k(!0);try{const s=(await N.get(`/users/search?query=${encodeURIComponent(e)}`)).data;w(s.users||[]),D(s.searchType)}catch(t){P({title:"Error",description:(null==(a=null==(s=t.response)?void 0:s.data)?void 0:a.error)||"Failed to search users",variant:"destructive"})}finally{k(!1)}})(c)},300);return()=>clearTimeout(e)},[c]),e.jsxs(x,{className:"w-full max-w-2xl mx-auto",children:[e.jsx(o,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(s,{className:"h-5 w-5"}),"Cari Pengguna"]})}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(C,{type:"text",placeholder:"Cari berdasarkan ID unik (contoh: ABC12345) atau nama...",value:c,onChange:e=>b(e.target.value),className:"pl-10"})]}),c.trim().length>=2&&e.jsx("div",{className:"text-sm text-gray-600",children:y?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"Mencari..."]}):e.jsxs("div",{children:["unique_id"===S&&"Pencarian berdasarkan ID unik","name"===S&&"Pencarian berdasarkan nama",v.length>0&&` - ${v.length} hasil ditemukan`]})}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:v.map(s=>{return e.jsx(x,{className:"hover:shadow-md transition-shadow cursor-pointer",children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",onClick:()=>null==n?void 0:n(s),children:[e.jsxs(j,{className:"h-12 w-12",children:[e.jsx(p,{src:s.avatar_url,alt:s.full_name}),e.jsx(g,{className:"bg-gradient-to-br from-blue-500 to-purple-600 text-white font-semibold",children:s.full_name.split(" ").map(e=>e[0]).join("").toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:s.full_name}),e.jsxs(_,{variant:"secondary",className:(c=s.level,c>=50?"bg-purple-500":c>=30?"bg-blue-500":c>=15?"bg-green-500":c>=5?"bg-yellow-500":"bg-gray-500")+" text-white text-xs",children:["Level ",s.level]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{className:"font-mono font-semibold text-blue-600",children:["#",s.unique_id]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(t,{className:"h-3 w-3"}),e.jsxs("span",{children:[s.xp.toLocaleString()," XP"]})]}),s.school_name&&e.jsx("div",{className:"flex items-center gap-1 truncate",children:e.jsx("span",{className:"truncate",children:s.school_name})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mt-1",children:[s.grade_level&&e.jsxs("span",{children:["Kelas ",s.grade_level]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{className:"h-3 w-3"}),e.jsxs("span",{children:["Bergabung ",(a=s.created_at,new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"long"}))]})]})]})]})]}),i&&e.jsxs(f,{size:"sm",variant:"outline",onClick:e=>{e.stopPropagation(),(async(e,s)=>{var a,t;try{const a=(await N.post("/users/friends/request",{targetUserId:e})).data;P({title:"Success",description:a.message||`Friend request sent to ${s}!`})}catch(l){P({title:"Error",description:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.error)||"Failed to send friend request",variant:"destructive"})}})(s.id,s.full_name)},className:"ml-3 flex items-center gap-1",children:[e.jsx(r,{className:"h-4 w-4"}),"Tambah Teman"]})]})})},s.id);var a,c})}),c.trim().length>=2&&0===v.length&&!y&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(s,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-1",children:"Tidak ada pengguna ditemukan"}),e.jsx("p",{className:"text-sm",children:"Coba cari dengan ID unik (contoh: ABC12345) atau nama yang berbeda"})]}),c.trim().length<2&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(a,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-1",children:"Cari Pengguna"}),e.jsx("p",{className:"text-sm",children:"Masukkan ID unik atau nama pengguna untuk mencari teman baru"})]})]})]})},D=({onFriendSelect:a,showActions:r=!0})=>{const[b,v]=m.useState([]),[w,y]=m.useState(!0),{toast:k}=d(),C=e=>{if(!e)return"";return new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})};return m.useEffect(()=>{(async()=>{var e,s;y(!0);try{const e=await N.get("/users/friends");v(e.data.friends||[])}catch(a){k({title:"Error",description:(null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.error)||"Failed to load friends",variant:"destructive"})}finally{y(!1)}})()},[]),w?e.jsxs(x,{className:"w-full max-w-2xl mx-auto",children:[e.jsx(o,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(s,{className:"h-5 w-5"}),"Daftar Teman"]})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Memuat daftar teman..."})]})})]}):e.jsxs(x,{className:"w-full max-w-2xl mx-auto",children:[e.jsx(o,{children:e.jsxs(h,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s,{className:"h-5 w-5"}),"Daftar Teman"]}),e.jsxs(_,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[b.length," teman"]})]})}),e.jsx(u,{children:0===b.length?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(s,{className:"h-16 w-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-xl font-medium mb-2",children:"Belum ada teman"}),e.jsx("p",{className:"text-sm",children:"Mulai cari dan tambahkan teman untuk belajar bersama!"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:b.map(s=>{return e.jsx(x,{className:"hover:shadow-md transition-shadow",children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 cursor-pointer",onClick:()=>null==a?void 0:a(s),children:[e.jsxs("div",{className:"relative",children:[e.jsxs(j,{className:"h-12 w-12",children:[e.jsx(p,{src:s.avatar_url,alt:s.full_name}),e.jsx(g,{className:"bg-gradient-to-br from-blue-500 to-purple-600 text-white font-semibold",children:s.full_name.split(" ").map(e=>e[0]).join("").toUpperCase()})]}),s.is_online&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 border-2 border-white rounded-full"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:s.full_name}),e.jsxs(_,{variant:"secondary",className:(m=s.level,m>=50?"bg-purple-500":m>=30?"bg-blue-500":m>=15?"bg-green-500":m>=5?"bg-yellow-500":"bg-gray-500")+" text-white text-xs",children:["Level ",s.level]}),s.level>=30&&e.jsx(n,{className:"h-4 w-4 text-yellow-500 fill-current"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{className:"font-mono font-semibold text-blue-600",children:["#",s.unique_id]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(t,{className:"h-3 w-3"}),e.jsxs("span",{children:[s.xp.toLocaleString()," XP"]})]}),s.school_name&&e.jsx("div",{className:"flex items-center gap-1 truncate",children:e.jsx("span",{className:"truncate",children:s.school_name})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mt-1",children:[s.grade_level&&e.jsxs("span",{children:["Kelas ",s.grade_level]}),s.friendship_date&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{className:"h-3 w-3"}),e.jsxs("span",{children:["Berteman sejak ",C(s.friendship_date)]})]})]})]})]}),r&&e.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[e.jsxs(f,{size:"sm",variant:"outline",onClick:e=>{e.stopPropagation(),k({title:"Coming Soon",description:"Chat feature will be available soon!"})},className:"flex items-center gap-1",children:[e.jsx(i,{className:"h-4 w-4"}),"Chat"]}),e.jsxs(f,{size:"sm",variant:"outline",onClick:e=>{e.stopPropagation(),confirm(`Apakah Anda yakin ingin menghapus ${s.full_name} dari daftar teman?`)&&(async(e,s)=>{var a,t;try{await N.delete(`/users/friends/${e}`),v(b.filter(s=>s.id!==e)),k({title:"Success",description:`${s} has been removed from your friends`})}catch(l){k({title:"Error",description:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.error)||"Failed to remove friend",variant:"destructive"})}})(s.id,s.full_name)},className:"flex items-center gap-1 text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(c,{className:"h-4 w-4"}),"Hapus"]})]})]})})},s.id);var m})})})]})},P=()=>{const[l,r]=m.useState(null),[c,d]=m.useState("friends"),j=e=>{r(e)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[e.jsx(b,{}),e.jsxs("div",{className:"max-w-6xl mx-auto p-4 pt-20",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full",children:e.jsx(s,{className:"h-8 w-8 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Komunitas Belajar"})]}),e.jsx("p",{className:"text-gray-600 text-lg max-w-2xl mx-auto",children:"Temukan teman belajar, berbagi pengalaman, dan tingkatkan prestasi bersama-sama!"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(x,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Total Pengguna"}),e.jsx("p",{className:"text-3xl font-bold",children:"12,847"})]}),e.jsx(s,{className:"h-12 w-12 text-blue-200"})]})})}),e.jsx(x,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white",children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Aktif Hari Ini"}),e.jsx("p",{className:"text-3xl font-bold",children:"3,241"})]}),e.jsx(i,{className:"h-12 w-12 text-green-200"})]})})}),e.jsx(x,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"Top Performers"}),e.jsx("p",{className:"text-3xl font-bold",children:"856"})]}),e.jsx(t,{className:"h-12 w-12 text-purple-200"})]})})})]}),e.jsxs(v,{value:c,onValueChange:d,className:"w-full",children:[e.jsxs(w,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsxs(y,{value:"friends",className:"flex items-center gap-2",children:[e.jsx(s,{className:"h-4 w-4"}),"Teman Saya"]}),e.jsxs(y,{value:"search",className:"flex items-center gap-2",children:[e.jsx(a,{className:"h-4 w-4"}),"Cari Teman"]})]}),e.jsx(k,{value:"friends",className:"space-y-6",children:e.jsx(D,{onFriendSelect:j,showActions:!0})}),e.jsxs(k,{value:"search",className:"space-y-6",children:[e.jsx(S,{onUserSelect:j,showAddFriend:!0}),e.jsxs(x,{className:"bg-gradient-to-r from-blue-50 to-purple-50 border-blue-200",children:[e.jsx(o,{children:e.jsxs(h,{className:"text-lg text-blue-800 flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5"}),"Tips Pencarian"]})}),e.jsxs(u,{className:"text-sm text-blue-700 space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("p",{children:["Gunakan ",e.jsx("strong",{children:"ID unik"})," (contoh: ABC12345) untuk pencarian yang lebih akurat"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("p",{children:["Cari berdasarkan ",e.jsx("strong",{children:"nama lengkap"})," untuk menemukan teman sekelas"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("p",{children:"Tambahkan teman untuk berbagi progress dan saling memotivasi"})]})]})]})]})]}),l&&e.jsxs(x,{className:"fixed inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:transform md:-translate-x-1/2 md:-translate-y-1/2 md:w-96 z-50 shadow-2xl",children:[e.jsx(o,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{className:"text-lg",children:"Profil Pengguna"}),e.jsx("button",{onClick:()=>r(null),className:"text-gray-400 hover:text-gray-600 text-xl font-bold",children:"Ã—"})]})}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-2xl font-bold mx-auto mb-3",children:l.full_name.split(" ").map(e=>e[0]).join("").toUpperCase()}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:l.full_name}),e.jsxs("p",{className:"text-blue-600 font-mono font-semibold",children:["#",l.unique_id]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Level:"}),e.jsxs(_,{className:(g=l.level,g>=50?"bg-purple-500":g>=30?"bg-blue-500":g>=15?"bg-green-500":g>=5?"bg-yellow-500":"bg-gray-500")+" text-white",children:["Level ",l.level]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"XP:"}),e.jsx("span",{className:"font-semibold",children:l.xp.toLocaleString()})]}),l.school_name&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Sekolah:"}),e.jsx("span",{className:"font-medium text-right flex-1 ml-2 truncate",children:l.school_name})]}),l.grade_level&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Kelas:"}),e.jsx("span",{className:"font-medium",children:l.grade_level})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Bergabung:"}),e.jsx("span",{className:"font-medium",children:(p=l.created_at,new Date(p).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}))})]})]})]})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>r(null)})]})]});var p,g};export{P as default};
//# sourceMappingURL=SocialPage-Drxn1w98.js.map
